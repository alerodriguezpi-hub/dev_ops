name: build image

on:
  push:
    branches: [pipln] //nombre de la rama

    jobs:
    build:
        runs-on: ubuntu-latest


        steps:
          - name: checkout
            uses: actions/checkout@v5

          - name: configurar python
            uses: actions/setup-python@v5
            with:
              python-version: '3.10'

          - name: Instalar dependencias
            run: pip install flask

          - name: Ejecutar las pruebas unitarias
            run: python test.py

          - name: Login a Github Packages
            uses: docker/Login-action@v2
            with:
              resgistry: ghcr.io
              username: ${{ github.actor }}
              password: ${{ secrets.GITHUB_TOKEN }}

          - name: Construir y publicar
            uses: docker/build-push-action@v4
            with:
              context: .
              push: true
              tags: ghcr.io/${{. github.repository_owner }}/python_app:latest

